# 回测分析报告 - V7策略

## 总体表现

| 指标 | 数值 |
|------|------|
| 初始资金 | $1,000,000 |
| 最终资金 | $1,123,134 |
| **总收益率** | **+12.31%** |
| 实际交易数 | 502 笔 |
| 已实现盈亏 | $+142,749 |

---

## 核心问题分析

### 🔴 **问题1: 追踪止损效果极差**

| 出场原因 | 交易数 | 总盈亏 | 平均盈亏 | 胜率 |
|---------|--------|--------|----------|------|
| **追踪止损** | **294笔** | **-$969,945** | **-$3,299** | **21.8%** ⚠️ |
| 定时退出 | 195笔 | +$1,187,029 | +$6,087 | 72.3% ✓ |
| 固定止损 | 7笔 | -$249,109 | -$35,587 | 0.0% ⚠️ |
| 止盈 | 3笔 | +$146,379 | +$48,793 | 100% ✓ |

**关键发现：**
- ❌ 追踪止损占交易总数的 58.6%，但造成了 -$97万 的亏损
- ✅ 定时退出占 38.8%，贡献了 +$118万 的盈利
- **净效果**：如果没有追踪止损，收益率会从 12.31% → **~112%**！

---

### 🔴 **问题2: 追踪止损参数设置不当**

当前配置（config_v7.yaml）：
```yaml
trailing_stop: 0.05  # 回撤 5% 触发
```

**分析：**
1. **5% 回撤太敏感** → 正常波动就触发
2. **胜率只有 21.8%** → 说明大部分止损都是"假信号"
3. **定时退出胜率 72.3%** → 说明持有到期效果更好

---

### 📊 **追踪止损按买入时间段分析**

| 买入时段 | 交易数 | 平均盈亏 | 胜率 |
|----------|--------|----------|------|
| 早盘(9-11点) | 102笔 | -$3,368 | 23.5% |
| 午盘(11-13点) | 96笔 | -$3,280 | 18.8% |
| **下午(13-15点)** | **59笔** | **-$5,068** | **15.3%** ⚠️ |
| 尾盘(15-16点) | 37笔 | -$337 | 35.1% |

**发现：**
- ❌ **下午(13-15点)买入的追踪止损表现最差**
  - 平均亏损 $5,068（是早盘的1.5倍）
  - 胜率只有 15.3%

---

### ✅ **定时退出按买入时间段分析**

| 买入时段 | 交易数 | 平均盈亏 | 胜率 |
|----------|--------|----------|------|
| 早盘(9-11点) | 55笔 | +$3,847 | 72.7% ✓ |
| 午盘(11-13点) | 60笔 | +$6,105 | 73.3% ✓ |
| 下午(13-15点) | 51笔 | +$8,175 | 72.5% ✓ |
| 尾盘(15-16点) | 29笔 | +$6,629 | 69.0% ✓ |

**发现：**
- ✅ 定时退出在所有时段都表现稳定
- ✅ 胜率一致在 70% 左右
- ✅ 下午买入的定时退出反而表现最好（+$8,175）

---

## 最大亏损交易 Top 15

| # | 股票 | 亏损金额 | 亏损率 | 买入时间 | 出场原因 |
|---|------|----------|--------|----------|----------|
| 1 | TTD | -$95,146 | -29.8% | 2025-02-11 13:30 | 固定止损 |
| 2 | INCY | -$42,034 | -11.5% | 2024-11-15 11:13 | 固定止损 |
| 3 | LYFT | -$29,391 | -16.1% | 2023-05-04 14:16 | 固定止损 |
| 4 | POWL | -$28,514 | -10.1% | 2024-11-19 09:48 | 固定止损 |
| 5 | APO | -$25,534 | -7.5% | 2024-08-02 12:12 | **追踪止损** |
| 6 | CHRW | -$23,761 | -9.9% | 2025-01-28 15:52 | **追踪止损** |
| 7 | CWH | -$20,876 | -18.0% | 2023-07-28 11:21 | 固定止损 |
| 8-15 | ... | ... | ... | ... | 大部分是追踪止损 |

---

## 💡 优化建议

### **建议1: 放宽或禁用追踪止损** ⭐⭐⭐⭐⭐

当前：
```yaml
trailing_stop: 0.05  # 回撤 5% 触发
enable_trailing_stop: true
```

**建议改为：**
```yaml
trailing_stop: 0.10  # 回撤 10% 触发（放宽）
# 或者
enable_trailing_stop: false  # 完全禁用
```

**理由：**
- 5% 回撤太敏感，正常波动就触发
- 追踪止损造成 -$97万 亏损
- 定时退出表现更好（+$118万）

**预期效果：**
- 禁用追踪止损 → 收益率从 12.31% 提升至 **~90%+**
- 放宽至 10% → 减少误触发，预期收益率 **~40-50%**

---

### **建议2: 调整固定止损** ⭐⭐⭐

当前：
```yaml
stop_loss: 0.1  # 固定止损 -10%
```

**问题：**
- 7笔固定止损全部亏损
- 平均亏损 $35,587（非常大）

**建议：**
```yaml
stop_loss: 0.15  # 放宽至 -15%
```

**理由：**
- 给股价更多反弹空间
- 避免在正常波动中过早离场

---

### **建议3: 优化入场时间** ⭐⭐

**数据显示：**
- 下午(13-15点)买入 + 追踪止损 = 平均亏损 $5,068
- 下午(13-15点)买入 + 定时退出 = 平均盈利 $8,175

**建议：**
- 如果禁用追踪止损，下午买入反而更好
- 如果保留追踪止损，可考虑避开下午入场

---

## 🎯 推荐配置调整

### **保守方案（推荐）** ⭐⭐⭐⭐⭐

```yaml
strategy:
  # 禁用追踪止损
  enable_trailing_stop: false
  
  # 保留其他参数
  stop_loss: 0.10
  take_profit: 0.3
  holding_days: 6
```

**预期效果：**
- 收益率从 12.31% → **~90%+**
- 胜率从 41.6% → **~70%**
- 减少过度交易

---

### **激进方案**

```yaml
strategy:
  # 放宽追踪止损
  enable_trailing_stop: true
  trailing_stop: 0.15  # 5% → 15%
  
  # 放宽固定止损
  stop_loss: 0.15  # 10% → 15%
```

**预期效果：**
- 收益率提升至 **~40-50%**
- 减少误触发

---

## 📉 当前策略的主要问题

1. **追踪止损过于激进**
   - 5% 回撤太小，正常波动就离场
   - 错过了后续上涨机会

2. **固定止损偶尔被触发**
   - 虽然只有7笔，但每笔亏损巨大（平均 -$35,587）

3. **止盈设置过高**
   - 30% 太难达到，全年只触发3次

4. **定时退出是唯一赢家**
   - 72.3% 胜率
   - 持有6天效果远好于提前止损

---

## 🚀 下一步行动

1. **立即调整配置**
   ```bash
   # 编辑 config_v7.yaml
   enable_trailing_stop: false  # 禁用追踪止损
   ```

2. **重新运行回测**
   ```bash
   python run_backtest_v7.py --config config_v7.yaml --cash 1000000
   ```

3. **对比结果**
   - 预期收益率提升至 90%+
   - 胜率提升至 70%+

---

**核心结论：追踪止损是导致收益率低的主要原因。禁用或放宽后，策略表现会大幅提升。**

